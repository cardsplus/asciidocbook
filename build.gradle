/*
 * https://guides.gradle.org/creating-new-gradle-builds/
 */

plugins {
    id 'java'
    id "com.palantir.git-version" version "0.12.3"
    id "org.asciidoctor.jvm.convert" version "3.2.0"
    id 'org.asciidoctor.jvm.pdf' version '3.2.0'
    id 'org.asciidoctor.jvm.gems' version '3.2.0'
}

description = 'cards+ asciidoc book'
version = gitVersion();

repositories {
    jcenter()
    ruby.gems()
}

dependencies {
  asciidoctorGems 'rubygems:rouge:3.22.0'
}

asciidoctorj {
  logLevel 'INFO'
  requires 'rouge'
  options doctype: 'book'
  attributes 'source-highlighter': 'rouge'
  attributes 'icons': 'font'
  attributes 'toc': 'left'
  attributes 'sectlink': true
  attributes 'sectanchors': true
  attributes 'numbered': true
  attributes 'idprefix': ''
  attributes 'idseparator': '-'
  attributes 'title': description
  attributes 'author': 'Robert Bruckbauer'
  attributes 'email':  'bruckbauer@gmx.at'
  attributes 'website': 'https://cardsplus.info'
  attributes 'revnumber': version
  attributes 'revdate': new Date().format('yyyy/MM/dd')
  attributes 'revyear': new Date().format('yyyy')
  attributes 'imagesdir': 'images'
}

asciidoctor {
  dependsOn asciidoctorGemsPrepare
  baseDirFollowsSourceFile()
  sourceDir file('doc')
  sources {
    include 'book.adoc'
  }
  languages 'de'
  outputDir file('build/html')
  outputs.upToDateWhen { false }
}

asciidoctorPdf {
  dependsOn asciidoctorGemsPrepare
  baseDirFollowsSourceFile()
  sourceDir file('doc')
  sources {
    include 'book.adoc'
  }
  languages 'de'
  outputDir file('build/pdf')
  outputs.upToDateWhen { false }
}
